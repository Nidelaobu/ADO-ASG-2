Creating of Tables:
CREATE OR REPLACE TABLE DIM_LOCATION AS
SELECT DISTINCT
    iso_code AS LOCATION_ID,
    country AS COUNTRY_NAME
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;

CREATE OR REPLACE TABLE DIM_DATE AS
SELECT DISTINCT
    year AS YEAR_ID
FROM OWID_ENERGY_DATA_RAW;

CREATE OR REPLACE TABLE FACT_ECONOMY AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    population,
    gdp
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;

CREATE OR REPLACE TABLE FACT_ELECTRICITY AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    electricity_demand,
    electricity_generation,
    per_capita_electricity,
    carbon_intensity_elec,
    greenhouse_gas_emissions
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;


CREATE OR REPLACE TABLE FACT_COAL AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(coal_consumption, 0) AS CONSUMPTION,
    COALESCE(coal_production, 0) AS PRODUCTION,
    COALESCE(coal_electricity, 0) AS ELECTRICITY_GENERATED,
    COALESCE(coal_share_energy, 0) AS SHARE_OF_ENERGY
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;


CREATE OR REPLACE TABLE FACT_OIL AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(oil_consumption, 0) AS CONSUMPTION,
    COALESCE(oil_production, 0) AS PRODUCTION,
    COALESCE(oil_electricity, 0) AS ELECTRICITY_GENERATED,
    COALESCE(oil_share_energy, 0) AS SHARE_OF_ENERGY
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;

CREATE OR REPLACE TABLE FACT_GAS AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(gas_consumption, 0) AS CONSUMPTION,
    COALESCE(gas_production, 0) AS PRODUCTION,
    COALESCE(gas_electricity, 0) AS ELECTRICITY_GENERATED
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;

CREATE OR REPLACE TABLE FACT_NUCLEAR AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(nuclear_consumption, 0) AS CONSUMPTION,
    COALESCE(nuclear_electricity, 0) AS ELECTRICITY_GENERATED,
    COALESCE(nuclear_share_energy, 0) AS SHARE_OF_ENERGY
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;


CREATE OR REPLACE TABLE FACT_HYDRO AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(hydro_consumption, 0) AS CONSUMPTION,
    COALESCE(hydro_electricity, 0) AS ELECTRICITY_GENERATED
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;


CREATE OR REPLACE TABLE FACT_SOLAR AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(solar_consumption, 0) AS CONSUMPTION,
    COALESCE(solar_electricity, 0) AS ELECTRICITY_GENERATED
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;


CREATE OR REPLACE TABLE FACT_WIND AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(wind_consumption, 0) AS CONSUMPTION,
    COALESCE(wind_electricity, 0) AS ELECTRICITY_GENERATED
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;

CREATE OR REPLACE TABLE FACT_BIOFUEL AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(biofuel_consumption, 0) AS CONSUMPTION,
    COALESCE(biofuel_electricity, 0) AS ELECTRICITY_GENERATED
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;


CREATE OR REPLACE TABLE FACT_RENEWABLES_TOTAL AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(renewables_consumption, 0) AS TOTAL_CONSUMPTION,
    COALESCE(renewables_share_energy, 0) AS TOTAL_SHARE
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;


CREATE OR REPLACE TABLE FACT_FOSSIL_TOTAL AS
SELECT
    iso_code AS LOCATION_ID,
    year AS YEAR_ID,
    COALESCE(fossil_fuel_consumption, 0) AS TOTAL_CONSUMPTION,
    COALESCE(fossil_share_energy, 0) AS TOTAL_SHARE
FROM OWID_ENERGY_DATA_RAW
WHERE iso_code IS NOT NULL;
